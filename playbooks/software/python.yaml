- name: Install Python Requirements
  hosts: cores
  tasks:
  - name: Create install directory
    ansible.builtin.file:
      path: ~/install_rupert
      state: directory
  - name: Install python3.11
    ansible.builtin.apt:
      name: python3.11
      state: present
      update_cache: true
    become: true
  - name: Install libpython3.11
    ansible.builtin.apt:
      name: libpython3.11
      state: present
      update_cache: false
    become: true
  - name: Download get-pip.py
    ansible.builtin.get_url:
      url: https://bootstrap.pypa.io/get-pip.py
      dest: ~/install_rupert/get-pip.py
      force: false
  - name: Install pip3.11
    ansible.builtin.shell: python3.11 ~rupert/install_rupert/get-pip.py
    args:
      creates: /usr/local/bin/pip3.11
    become: true
  - name: Upgrade pip3.11 to ensure latest version
    ansible.builtin.shell: python3.11 -m pip install --upgrade pip
    become: true
  - name: Install python-vlc
    ansible.builtin.pip:
      name: python-vlc
      extra_args:
        --user
        --upgrade
      executable: pip3.11
  - name: Install confluent-kafka
    ansible.builtin.pip:
      name: confluent-kafka
      extra_args:
        --user
        --upgrade
      executable: pip3.11
  - name: Install BearType
    ansible.builtin.pip:
      name: beartype
      extra_args:
        --user
        --upgrade
      executable: pip3.11
  - name: Install PyMongo
    ansible.builtin.pip:
      name: pymongo
      extra_args:
        --user
        --upgrade
      executable: pip3.11